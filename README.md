# CuttleFlow

CuttleFlow is a tool that rewrites Data Analysis Workflows (DAW) according to their execution context (input data and computer/cluster the DAW is running on).
It can replace tools with similar ones where appropriate, while maintaining the workflow structure and outputs.
It can parallelize some tasks across multiple nodes of a cluster when appropriate, depending on the execution context.
It will set the appropriate number of threads on the DAW tasks.
To run our program on the *rnasplice* workflow, run the following commands
```
bash cuttleflow.sh --descriptionFolder test/rnasplice-description --output ../generated_daw_rnasplice_test
```

By changing the `--description folder` argument, you can load a different workflow, input and infrastructure description. 
You can change the output folder where the DAW is generated by changing the path of the `--output' argument.

## Creating your own description files

The description files consist of
```
description_folder
|-- DAW.json
|-- INFRA.json
|-- INPUT.json
|-- SPLIT_MERGE_TASKS.json
```

- DAW.json' contains the DAW declaration, including the inputs and outputs of the various tasks, and the path to the Nextflow modules to be used.
- INFRA.json' contains the description of the machine or cluster you want to run your workflow on.
- INPUT.json' contains information about your input data and its paths.
- SPLIT_MERGE_TASKS.json is a file that you will need to edit to add your own parallelisation logic.

## Adding tool annotations

If you have annotated some bio-tools so that they can be replaced or split by CuttleFlow, please edit the following files

- `source/annotation_files/infrastructure_runtime`: add a description of the infrastructure you ran your tool on.
- `source/annotation_files/': add the description of your tool here. 
- source/annotation_files/runtime_aligners.csv': add the runtime of your tool here